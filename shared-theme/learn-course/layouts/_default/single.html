{{ define "main" }}
<article class="module-content">
  <header class="module-header">
    <div class="module-meta">
      <span class="module-badge">Module {{ .Params.module }}</span>
      <span class="module-duration">{{ .Params.duration | default "30 min" }}</span>
      {{ if .Params.difficulty }}
      <span class="module-difficulty module-difficulty--{{ .Params.difficulty }}">{{ .Params.difficulty }}</span>
      {{ end }}
    </div>
    <h1 class="module-title">{{ .Title }}</h1>
    {{ with .Params.description }}
    <p class="module-description">{{ . }}</p>
    {{ end }}
  </header>

  {{ if .Params.objectives }}
  <section class="objectives-section">
    <h2 class="objectives-title">Learning Objectives</h2>
    <ul class="objectives-list">
      {{ range .Params.objectives }}
      <li class="objective-item">
        <span class="objective-bullet"></span>
        <span class="objective-text">{{ . }}</span>
      </li>
      {{ end }}
    </ul>
  </section>
  {{ end }}

  <div class="module-body prose">
    {{ .Content }}
  </div>

  {{ $quizPath := printf "%s/quiz.json" .File.Dir }}
  {{ if fileExists $quizPath }}
  <section class="quiz-section" id="quiz">
    <h2 class="quiz-title">Quiz</h2>
    <p class="quiz-description">Complete this quiz with a minimum score of {{ .Site.Params.quizPassScore | default 80 }}% to mark Module {{ .Params.module }} as complete.</p>
    <div class="quiz-container" 
         data-quiz-path="{{ .RelPermalink }}quiz.json"
         data-module="{{ .Params.module }}"
         data-pass-score="{{ .Site.Params.quizPassScore | default 80 }}">
      <div class="quiz-loading">Loading quiz...</div>
    </div>
  </section>
  {{ end }}
</article>
{{ end }}
